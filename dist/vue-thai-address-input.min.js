/*!
 * vue-thai-address-input v0.2.1
 * (c) 2018 tsctao
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.VueThaiAddressInput=t.VueThaiAddressInput||{})}(this,function(t){"use strict";function e(t,e){void 0===e&&(e={}),t.component("ThaiAddressInput",n);var s=e.database||"https://tsctao.github.io/vue-thai-address-input/dist/db.json";t.prototype.$thaiAddressInput=new i(s)}var s=function(t,e,s){this.useLookup=t,this.lookup=e,this.words=s};s.prototype.decode=function(t){var e=this;if(!this.useLookup)return t;var s=t;return"number"==typeof t&&(s=this.lookup[t]),s.replace(/[A-Z]/gi,function(t){var s=t.charCodeAt(0);return e.words[s<97?s-65:26+s-97]})};var i=function(t){var e=this;if("string"==typeof t&&/^https?:\/\//.test(t.substring(0,8))){this.data=[];var s=new XMLHttpRequest;s.open("GET",t,!0),s.onload=function(){if(s.status>=200&&s.status<400){var t=JSON.parse(s.responseText);e.data=e.constructor.extractDataFromDb(t)}},s.send()}else this.data=this.constructor.extractDataFromDb(t)};i.extractDataFromDb=function(t){var e=t.lookup&&t.words,i=e?t.data:t;if(!i[0].length)return i;var n=[],r=e?t.lookup.split("|"):[],o=e?t.words.split("|"):[],u=new s(e,r,o);return i.forEach(function(t){var e=3===t.length,s=e?2:1;t[s].forEach(function(i){i[s].forEach(function(r){(Array.isArray(r[s])?r[s]:[r[s]]).forEach(function(s){var o={subdistrict:u.decode(r[0]),district:u.decode(i[0]),province:u.decode(t[0]),postalCode:""+s};e&&(o.subdistrict_code=r[1]||!1,o.district_code=i[1]||!1,o.province_code=t[1]||!1),n.push(o)})})})}),n},i.prototype.query=function(t){return this.data.filter(function(e){return Object.keys(t).every(function(s){return 0===e[s].indexOf(t[s])})})},i.prototype.search=function(t,e){void 0===e&&(e=["postalCode","subdistrict","district","province"]);var s={province:[],district:[],subdistrict:[],postalCode:[]};return this.data.forEach(function(e){return Object.keys(e).some(function(i){var n=0===e[i].indexOf(t);return n&&s[i].push(e),n})}),e.reduce(function(t,e){return t.concat(s[e])},[])};var n={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"thai-address-input"},[s("input",{ref:"input",class:t.inputClass,attrs:{type:"text",placeholder:t.placeholder,disabled:t.disabled,required:t.required},domProps:{value:t.value},on:{input:function(e){t.onType(e.target.value)},focus:t.onFocus,blur:t.onBlur,keydown:[function(e){if(!("button"in e)&&t._k(e.keyCode,"up",38,e.key))return null;e.preventDefault(),t.cursorUp(e)},function(e){if(!("button"in e)&&t._k(e.keyCode,"down",40,e.key))return null;e.preventDefault(),t.cursorDown(e)}],keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.selectItem()}}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isFocus,expression:"isFocus"}],staticClass:"suggestion-list"},t._l(t.suggestions,function(e,i){return s("div",{staticClass:"suggestion-list-item",class:{cursor:t.cursor===i},on:{click:function(s){t.selectItem(e)}}},[t._v(" "+t._s(t.suggestionText(e))+" ")])}))])},staticRenderFns:[],name:"ThaiAddressInput",props:{type:{type:String,required:!0},minLength:{type:Number,default:2},value:{required:!0},placeholder:{type:String},disabled:{type:Boolean,default:!1},inputClass:{type:String},required:{type:Boolean,default:!1}},data:function(){return{suggestions:[],isFocus:!1,cursor:0}},methods:{query:function(){if(this.cursor=0,this.value.length<this.minLength)this.suggestions=[];else{this.suggestions="search"===this.type?this.$thaiAddressInput.search(this.value):this.$thaiAddressInput.query((t={},t[this.type]=this.value,t));var t}},suggestionText:function(t){var e=t.province&&t.province.indexOf("\u0e01\u0e23\u0e38\u0e07\u0e40\u0e17\u0e1e")>-1,s=e?"\u0e41\u0e02\u0e27\u0e07":"\u0e15\u0e33\u0e1a\u0e25",i=e?"\u0e40\u0e02\u0e15":"\u0e2d\u0e33\u0e40\u0e20\u0e2d",n=[];return t.subdistrict&&n.push(""+s+t.subdistrict),t.district&&n.push(""+i+t.district),t.province&&n.push(t.province),t.postalCode&&n.push(t.postalCode),n.join(" \xbb ")},changeValue:function(t){this.$emit("input",t)},selectItem:function(t){void 0===t&&(t=null),t||(t=this.suggestions[this.cursor]),t[this.type]&&this.changeValue(t[this.type]),this.isFocus=!1,this.$refs.input.blur(),this.$emit("selected",t)},onType:function(t){var e=this;this.changeValue(t),this.$nextTick(function(){e.query()})},onFocus:function(){this.query(),this.isFocus=!0},onBlur:function(){var t=this;setTimeout(function(){t.isFocus=!1},200)},cursorUp:function(){this.cursor>0&&(this.cursor-=1)},cursorDown:function(){this.cursor<this.suggestions.length-1&&(this.cursor+=1)}}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(e);t.default=e,t.ThaiAddressInput=n,t.version="0.2.1",Object.defineProperty(t,"__esModule",{value:!0})});